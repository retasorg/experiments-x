# Trained Models Directory

This directory contains trained ML models generated by the training pipeline.

## Files Generated:

### Isolation Forest (Anomaly Detection):
- **isolation_forest.pkl** - Scikit-learn pickle format
- **isolation_forest.onnx** - ONNX format (⚠️ may fail to export - that's OK!)

### XGBoost (Binary Classification):
- **xgboost_classifier.pkl** - Scikit-learn pickle format
- **xgboost_classifier.json** - XGBoost native format (preferred)
- **xgboost_classifier.onnx** - ONNX format for deployment ✅

## File Sizes (Approximate):
- Isolation Forest: ~10-50 MB
- XGBoost: ~5-20 MB
- ONNX files: ~5-30 MB

## Usage:

### Python Inference (Testing):
```python
import pickle
with open('./models/xgboost_classifier.pkl', 'rb') as f:
    model = pickle.load(f)

predictions = model.predict(X_test)
```

### Rust Inference (Production):
```rust
// Use the ONNX files with `ort` crate
use ort::Session;

let session = Session::builder()?
    .with_model_from_file("models/xgboost_classifier.onnx")?;

let outputs = session.run(inputs)?;
```

## Expected Performance:

### XGBoost:
- Accuracy: 85-90%
- Precision: 88-91%
- Recall: 86-89%
- F1-Score: 87-90%

### Isolation Forest:
- Accuracy: 72-78%
- Precision: 70-75%
- Recall: 75-80%
- F1-Score: 72-77%

## Deployment:

### For Raspberry Pi / Edge Devices:
1. Copy **xgboost_classifier.onnx** to your device
2. Copy **scaler.pkl** from ./data/ (needed for preprocessing!)
3. Use ONNX Runtime in Rust (`ort` crate)

### Files Needed for Production:
```
deployment/
├── xgboost_classifier.onnx   ← From ./models/
└── scaler.pkl                 ← From ./data/ (CRITICAL!)
```

## Important Notes:

- **ONNX format** is preferred for deployment (cross-platform, Rust-compatible)
- **XGBoost ONNX export** is reliable (~95% success rate)
- **Isolation Forest ONNX export** is fragile (may fail - use XGBoost only if needed)
- Models are trained on UNSW-NB15 dataset (network intrusion detection)
- Don't commit large model files to git (add to .gitignore)

## Known Issues:

### Isolation Forest ONNX Export May Fail:
```
❌ Error exporting Isolation Forest: ...
This is a known issue with sklearn-onnx.
```

**Solution:** This is expected! Just use XGBoost (85-90% accuracy is enough for PoC).

## Regenerating:
```bash
# Full pipeline:
docker compose up

# Or step-by-step:
python 1_preprocess_data_FIXED.py
python 2_train_isolation_forest.py
python 3_train_xgboost.py
python 4_export_to_onnx.py
```
